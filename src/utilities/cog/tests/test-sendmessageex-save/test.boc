include ../test.boc;

function run_cog_save()
{
    $(COG) --scenario scenario.scn
           --save-file $(TESTSUITE_DIR)/save.bin
           >>$(RAW_OUTPUT)
           2>>$(RAW_OUTPUT);
}

function run_cog_load()
{
    $(COG) --scenario scenario.scn
           --save-file $(TESTSUITE_DIR)/save.bin
           --load-from-save
           >>$(RAW_OUTPUT)
           2>>$(RAW_OUTPUT);
}

echo "==== run 1 ====" >> $(RAW_OUTPUT);
call run_cog_save();
echo "==== run 2 ====" >> $(RAW_OUTPUT);
call run_cog_load();
echo "==== run 3 ====" >> $(RAW_OUTPUT);
call run_cog_load();
echo "==== run 4 ====" >> $(RAW_OUTPUT);
call run_cog_load();
echo "==== run 5 ====" >> $(RAW_OUTPUT);
call run_cog_load();

call process_raw_output();
call compare_output();
